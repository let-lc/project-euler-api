{
  "id": 902,
  "published": 1722160800,
  "content": "<p>A permutation $\\pi$ of $\\{1, \\dots, n\\}$ can be represented in <b>one-line notation</b> as $\\pi(1),\\ldots,\\pi(n) $. If all $n!$ permutations are written in lexicographic order then $\\textrm{rank}(\\pi)$ is the position of $\\pi$ in this 1-based list.</p>\n\n<p>For example, $\\text{rank}(2,1,3) = 3$ because the six permutations of $\\{1, 2, 3\\}$ in lexicographic order are:\n$$1, 2, 3\\quad 1, 3, 2 \\quad 2, 1, 3 \\quad 2, 3, 1 \\quad 3, 1, 2 \\quad 3, 2, 1$$\n</p>\n\n<p>For a positive integer $m$, we define the following permutation of $\\{1, \\dots, n\\}$ with $n = \\frac{m(m+1)}2$:\n$$\n\\begin{align}\n\\sigma(i) &amp;= \\begin{cases} \\frac{k(k-1)}2 + 1 &amp; \\textrm{if } i = \\frac{k(k + 1)}2\\textrm{ for }k\\in\\{1, \\dots, m\\};\\\\i + 1 &amp; \\textrm{otherwise};\\end{cases}\\\\\n\\tau(i) &amp;= ((10^9 + 7)i \\bmod n) + 1\\\\\n\\pi(i) &amp;= \\tau^{-1}(\\sigma(\\tau(i)))\n\\end{align}\n$$\n</p>\n\n<p>Define $\\displaystyle P(m) = \\sum_{k=1}^{m!} \\text{rank}(\\pi^k)$.<br>\nFor example, $P(2) = 4$, $P(3) = 780$ and $P(4) = 38810300$.</p>\n\n<p>\nFind $P(100)$. Give your answer modulo  $(10^9 + 7)$.\n</p>\n"
}